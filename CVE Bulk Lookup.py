# NIST Bulk CVE Lookup by Jay Chen
# Sample output
# CVE-ID, CVSS 3 Base Score, CVSS 2 Base Score
# CVE-2020-0710 , 7.5 HIGH  , 7.6 HIGH
import requests
import json
import time
from bs4 import BeautifulSoup

CVE_list = ["CVE-2020-0710","CVE-2018-20650","CVE-2017-14810","CVE-2018-15780","CVE-2015-8265",
            "CVE-2016-1718","CVE-2016-1309","CVE-2016-0046","CVE-2015-7681"
            ]

print("CVE-ID,","CVSS 3 Base Score,","CVSS 2 Base Score")

for CVEs in CVE_list:
    response = requests.get('https://nvd.nist.gov/vuln/detail/'+str(CVEs))
    soup = BeautifulSoup(response.content, 'html.parser')
    
    print(CVEs,",",soup.find_all('a')[40].get_text(),",",soup.find_all('a')[41].get_text()) #Adjust the "40" or "41" if the output isn't correct

    time.sleep(1)
#--------Troubleshoot Script below-------------------

#print(soup.prettify())
#counter = 0
#for x in range(100):
#    counter+=1
#    print(soup.find_all('a')[x].get_text())
#    print(counter)


#    print(CVEs)
#    print("CVSS 3 Base Score: " + soup.find_all('a')[39].get_text())
#    print("CVSS 2 Base Score: " + soup.find_all('a')[40].get_text())
#    print(" ")


