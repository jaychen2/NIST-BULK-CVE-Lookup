# NIST Bulk CVE Lookup by Jay Chen
import requests
import json
import time
from bs4 import BeautifulSoup

with open("cves.txt") as file:
    lines = [line.rstrip() for line in file]

response_starter = requests.get("https://nvd.nist.gov/vuln/detail/CVE-2021-27104") #Used to determine the start location of CVSS Score
soup_starter = BeautifulSoup(response_starter.content, 'html.parser')
counter = 0

for x in range(len(soup_starter.find_all('a'))):
    counter+=1
    if(soup_starter.find_all('a')[x].get_text()) == "National Vulnerability Database":
        starter_placement = counter
    else:
        None

print("CVE-ID,","CVSS 3 Base Score,","CVSS 2 Base Score")

starter_placement_plus_two = starter_placement+2
starter_placement_plus_three = starter_placement+3

for CVEs in lines:
    response = requests.get('https://nvd.nist.gov/vuln/detail/'+str(CVEs))
    soup = BeautifulSoup(response.content, 'html.parser')
    print(CVEs,",",soup.find_all('a')[starter_placement_plus_two].get_text(),",",soup.find_all('a')[starter_placement_plus_three].get_text())
    time.sleep(1)


